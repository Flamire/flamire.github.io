<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Flamire">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2024/04/29/task11/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="task11">
<meta property="og:url" content="http://example.com/2024/04/29/task11/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/redefine-og.webp">
<meta property="article:published_time" content="2024-04-28T16:00:00.000Z">
<meta property="article:modified_time" content="2025-03-05T10:05:07.732Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/momo.jpg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/momo.jpg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/momo.jpg">
    <!--- Page Info-->
    
    <title>
        
            task11 | Flamiblog
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Wonderhoy!!!","subtitle":{"text":[],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Flamiblog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">6</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">47</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">task11</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/momo.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Flamire</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-04-29</span>
        <span class="mobile">2024-04-29</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-03-05 18:05:07</span>
            <span class="mobile">2025-03-05 18:05:07</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<span id="more"></span>
<p>[TOC]</p>
<h3 id="1-CF1329E-Dreamoon-Loves-AA-E"><a href="#1-CF1329E-Dreamoon-Loves-AA-E" class="headerlink" title="1.  CF1329E - Dreamoon Loves AA [E]"></a>1.  CF1329E - Dreamoon Loves AA [E]</h3><h4 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h4><p>给定 $n,m,k$，有一个下标为 $0\sim n$ 的 <code>AB</code> 串 $s$，其中 $s_0$ 和 $s_n$ 必定为 <code>A</code>，另外有 $k$ 个位置为 <code>A</code></p>
<p>你需要选择恰好 $k$ 个 <code>B</code> 变为 <code>A</code>，使得更改完之后相邻两个 <code>A</code> 之间的距离的极差最小，求最小极差</p>
<p>$1\le n\le10^{15},0\le m\le4\times10^5,0\le k&lt;n-m$</p>
<h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>考虑对一个 $[l,r]$ 判断是否可能，那么相当于对于每个 $i$，需要满足 $lx_i\le a_i\le rx_i$，且 $\sum x=k+m+1$</p><p>令 $k\leftarrow k+m+1$，变形为 $\lceil\frac{a_i}r\rceil\le x_i\le\lfloor\frac{a_i}l\rfloor$，那么我们可以根据这个二分得出一个 $l$ 的上界，以及一个 $r$ 的下界</p><p>问题是有可能出现 $\lceil\frac{a_i}r\rceil&gt;\lfloor\frac{a_i}l\rfloor$，那么我们需要将 $r$ 调大或者 $l$ 调小</p><p>每个这样的限制可以重述为 $l\le x$ 或 $r\ge y$，那么我们显然是取 $l$ 较松的一个前缀，其余都取 $r$，直接枚举即可</p><p>复杂度 $O(m\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="2-ARC159E-Difference-Sum-Query-K"><a href="#2-ARC159E-Difference-Sum-Query-K" class="headerlink" title="2.  ARC159E - Difference Sum Query [K]"></a>2.  ARC159E - Difference Sum Query [K]</h3><h4 id="题面-1"><a href="#题面-1" class="headerlink" title="题面"></a>题面</h4><p>给定 $n,m$，以及 $m$ 个二元组 $(a_i,b_i)$：</p>
<p>定义 $x_i$ 如下过程的循环次数：</p>
<ul>
<li>初始 $L\leftarrow1,R\leftarrow n,t\leftarrow0$</li>
<li>令 $M\leftarrow\left\lfloor\dfrac{a_iL+b_iR}{a_i+b_i}\right\rfloor$</li>
<li>若 $i<M$，则令 $R\leftarrow M-1$，若 $i=M$，结束过程，若 $i>M$，则令 $L\leftarrow M+1$</li>
</ul>
<p>$q$ 次询问，每次给定 $c_i,d_i$，求 $\sum_{i=c_i}^{d_i-1}|x_i-x_{i+1}|$</p>
<p>$2\le n\le10^{15},1\le m\le100,1\le a_i,b_i\le1000,1\le q\le10^4,\max(\frac{a_i}{b_i},\frac{b_i}{a_i})\le2$</p>
<h4 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>考虑这棵树的中序遍历为 $1,2,\cdots,n$，也就是说 $i-1$ 和 $i$ 一定是祖孙关系，那么 $|x_i-x_{i+1}|$ 就是树上两点的距离，那么我们要求的就是区间虚树大小</p><p>对两个端点分别在树上搜索，剩下的事情是容易计算的，复杂度 $O(q\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="3-CF1924E-Paper-Cutting-Again-E"><a href="#3-CF1924E-Paper-Cutting-Again-E" class="headerlink" title="3.  CF1924E - Paper Cutting Again [E]"></a>3.  CF1924E - Paper Cutting Again [E]</h3><h4 id="题面-2"><a href="#题面-2" class="headerlink" title="题面"></a>题面</h4><p>给定 $n\times m$ 的方格纸，每次选择从当前的 $n+m-2$ 条横竖直线里选择一条剪开，将剪出来右边或下边的部分扔掉</p>
<p>问期望多少次操作后纸的面积 $&lt;k$</p>
<p>$1\le n,m\le10^6,2\le k\le10^{12}$</p>
<h4 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p class='h5' id="Flamire-做法"><a href="#Flamire-做法" class="headerlink" title="Flamire 做法"></a>Flamire 做法</h5><p>将随机过程视作：每次随机从所有的 $n+m-2$ 条直线中选择一条，如果已经被剪过则不计入贡献</p><p>考虑一条竖线产生贡献的概率（横线同理），我们可以将这个过程看作方格纸右下角的移动，其就是竖线右侧每个使面积 $\ge k$ 的右下角出现的概率，乘上 $\frac1{n+m-2}$</p><p>定义 $f(x,y)$ 表示一个点 $(x,y)$ 出现的概率，我们可以枚举出现在第几次操作，令 $g(x,y,i)$ 表示一个点 $(x,y)$ 在第 $i$ 次操作后出现的概率，则 $g(x,y,i)=\left(\dfrac{n-x+m-y}{n+m-2}\right)^i-2\left(\dfrac{n-x+m-y-1}{n+m-2}\right)^i-\left(\dfrac{n-x+m-y-2}{n+m-2}\right)^i$，可能需要特判 $x=n$ 与 $y=m$ 的情况，那么 $f$ 就可以通过等比数列求和求出</p><p>注意到 $f$ 的值只和 $x+y$ 有关，而每一列的点的 $x+y$ 是一个区间，因此我们可以处理一些前缀和，得到每条竖线的值右边区域的 $f$ 之和</p><p>复杂度 $O(n+m)$</p><h5 id="题解做法"><a href="#题解做法" class="headerlink" title="题解做法"></a>题解做法</h5><p>将随机过程视作：随机一个 $n+m-2$ 条直线的排列，依次剪每条直线，如果已经被剪过则不计入次数</p><p>我们把最后一次操作扔掉，对每条直线算切完之后仍然 $\ge k$ 的概率</p><p>对于一条竖线 $x=i$，满足条件的要求即为它在所有 $x=j(j&lt;i)$ 之前，以及在所有 $y=j(j&lt;\lfloor\frac ki\rfloor)$ 之前，这是一个自然数的倒数，容易 $O(n+m)$ 计算</p>
              </div>
            </details>
<hr>
<h3 id="4-CF1975G-Zimpha-Fan-Club-E-⭐"><a href="#4-CF1975G-Zimpha-Fan-Club-E-⭐" class="headerlink" title="4.  CF1975G - Zimpha Fan Club [E] ⭐"></a>4.  CF1975G - Zimpha Fan Club [E] ⭐</h3><h4 id="题面-3"><a href="#题面-3" class="headerlink" title="题面"></a>题面</h4><p>给定两个含有小写字母，<code>*</code>，<code>-</code> 的字符串 $s,t$</p>
<p>一个 <code>-</code> 可以和任意字符匹配，一个 <code>*</code> 可以和任意零个或多个字符匹配，问两个串是否能匹配</p>
<p>$1\le |s|,|t|\le2\times10^6$，12s</p>
<h4 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>只有 <code>-</code> 的字符串匹配是经典 fft，因此我们可以先排除字符串算法（</p><p>考虑 <code>*</code> 产生的影响，首先判掉没有 <code>*</code> 的前缀和后缀，它们必须对位匹配</p><p>如果前缀的第一个 <code>*</code> 在 $s$，后缀的第一个 <code>*</code> 在 $t$，那么不难发现这两个串一定能匹配，反过来同理</p><p>那么两个 <code>*</code> 都必须在一侧，假设在 $s$，此时如果 $t$ 内部还有 <code>*</code>，不难发现这两个串也一定能匹配</p><p>因此只用考虑 $t$ 没有 <code>*</code> 的情况，那么 $s$ 会被 <code>*</code> 拆成若干连续段，我们要判断这些连续段是否能依次匹配到 $t$ 中</p><p>一种显然的想法是首先找到第一个段的首次出现位置，然后找到第二个段在后面首次出现位置，一直找下去，但是如果每次对整个串做判断复杂度会很高</p><p>因此我们每次匹配一个段 $s_i$ 时，将当前 $t$ 的前 $2|s_i|$ 个字符拿出来匹配，如果匹配不上我们可以删除 $|s_i|$ 个字符，每个段最多匹配上一次，所以我们的总复杂度是 $O(n\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="5-CF1975H-378QAQ-and-Core-E"><a href="#5-CF1975H-378QAQ-and-Core-E" class="headerlink" title="5.  CF1975H - 378QAQ and Core [E]"></a>5.  CF1975H - 378QAQ and Core [E]</h3><h4 id="题面-4"><a href="#题面-4" class="headerlink" title="题面"></a>题面</h4><p>给定长为 $n$ 的小写字符串，重排这个字符串使得字典序最大的后缀最小</p>
<p>$1\le n\le10^6$</p>
<h4 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>这不是我们集训队互测吗。</p><p>不会证明。懒得证明。</p><p>考虑最大的若干字符，最后的最大后缀一定是这些字符代表的后缀之一，如 <code>aaaaabbbbcccccccddddd</code>，那么我们首先可以将一个 <code>d</code> 放在最后，去除它的影响</p><p>至于为什么这么做是对的：如果最后一个字符不是 <code>d</code>，我们把最后一个 <code>d</code> 后面的所有东西扔到某一个 <code>d</code> 前面，一定会让最后一个 <code>d</code>，以及前面的 <code>d</code> 的字典序都变小</p><p>接下来剩下的 <code>d</code> 需要都与 <code>a</code> 结合，那么我们就有了 4 个 <code>da</code></p><p>继续结合，<code>a</code> 不够用了，我们产出 1 个 <code>daa</code> 和 3 个 <code>dab</code></p><p>此时 <code>daa</code> 不可能是最大的后缀了，因此我们只用继续给 <code>dab</code> 加字符，得到 1 个 <code>dabb</code> 和 2 个 <code>dabc</code></p><p>继续加完 <code>c</code>，得到 2 个 <code>dabccc</code>，列出此时的所有字符串：<code>c,d-,daa,dabb,dabccc,dabccc</code></p><p>我们发现，每一轮对于每个最大值，直接在末尾添加当前最小的字符串就是对的</p><p>即使范围有重叠也是对的，很神奇吧。</p><p>按照这个写一下，用哈希比较字符串，就可以得到一个 $O(n)$ 做法</p>
              </div>
            </details>
<hr>
<h3 id="6-THUPC2024-Final-A-古明地枣的袜子-K-✔️"><a href="#6-THUPC2024-Final-A-古明地枣的袜子-K-✔️" class="headerlink" title="6.  THUPC2024 Final A - 古明地枣的袜子 [K] ✔️"></a>6.  THUPC2024 Final A - 古明地枣的袜子 [K] ✔️</h3><h4 id="题面-5"><a href="#题面-5" class="headerlink" title="题面"></a>题面</h4><p>有数组 $a_1,a_2,\cdots,a_n$，以及 $n$ 次前缀加操作，第 $i$ 次给 $a[1:x_i]$ 整体 $+y_i$</p>
<p>$q$ 次询问，每次给定 $[l,r]$，询问只保留第 $l$ 次到第 $r$ 次内的操作，$a$ 初值全 $0$，求操作完后 $\max_{i=1}^na_i$ 的值</p>
<p>$1\le n,q\le5\times10^5,|y_i|\le n$，10s</p>
<h4 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>看起来不好 polylog，考虑根号。</p><p>对 $a$ 分块，那么我们对于属于这个块的操作计算一下答案，将包含这个块的操作的值再加上即可</p><p>但是属于一个块的操作依然有可能有很多，我们对操作进行一些扰动，使得每个位置恰好被操作一次，这会导致我们有些下标的值不应该被计入答案，不过这是容易处理的</p><p>那么现在我们大小为 $B$ 的块只有 $B$ 次操作，我们可以枚举询问区间，是 $O(B^2)$ 的，如果我们可以在 $O(B^2)$ 的复杂度内算出一个块所有区间的答案，最后复杂度就是 $O(n\sqrt n)$ 的</p><p>直接用线段树之类的需要带一个 log，考虑如何不带 log</p><p>我们对 $a$ 的下标进行分治，对于区间 $[l,r]$，我们只需要保留 $O((r-l)^2)$ 种答案，容易支持 $[l,m]$ 和 $[m+1,r]$ 合并到 $[l,r]$，复杂度 $T(n)=2T(\frac n2)+O(n^2)$，解得 $T(n)=O(n^2)$，那么对于一个块我们的复杂度就是 $O(B^2)$ 的</p><p>总复杂度 $O(n\sqrt n)$</p>
              </div>
            </details>
<hr>
<h3 id="7-CF1119H-Triple-E"><a href="#7-CF1119H-Triple-E" class="headerlink" title="7.  CF1119H - Triple [E]"></a>7.  CF1119H - Triple [E]</h3><h4 id="题面-6"><a href="#题面-6" class="headerlink" title="题面"></a>题面</h4><p>给定 $n$ 组 $[0,2^k-1]$ 内的正整数 $\{a_i,b_i,c_i\}$，你需要从每组中选一个数</p>
<p>每组中选择 $a_i,b_i,c_i$ 的方案数分别为 $x,y,z$，其中 $x,y,z$ 为三个固定的常数，对所有 $n$ 组均一致</p>
<p>对每个 $t=0,1,\cdots,2^k-1$，求选出的数异或为 $t$ 的方案数，对 $998244353$ 取模</p>
<p>$1\le n\le10^5,1\le k\le17$</p>
<h4 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p class='h5' id="Flamire-做法"><a href="#Flamire-做法" class="headerlink" title="Flamire 做法"></a>Flamire 做法</h5><p>先异或 $a_i$，这样我们的一个数就变成 $0$ 了，方便处理</p><p>我们要求的就是 $\prod(x+yw^{b_i}+zw^{c_i})$，其中 $\prod$ 为形式幂级数的异或卷积</p><p>注意到只有 $(x+yw^{b_i})$，那么我们可以做一个类似于高维前缀和的东西将最后做完 fwtxor 变换的东西求出来，ifwt 回去就可以得到答案</p><p>那么我们考虑将 $(x+yw^{b_i}+zw^{c_i})$ 分解为一些两项的形式，考虑使用 $FWT(f)_S=\sum_T(-1)^{|S\cap|T}f_T$，我们随便设一些操作，然后高斯消元一下，得到：</p><ul><li>设 $v_{ij}$ 表示与 $b$ 交的大小奇偶性为 $i$，与 $c$ 交的大小奇偶性为 $j$，那么原来三项式进行 fwt 变换等价于对初始全 $1$ 的数组进行如下操作：</li><li>将所有数乘上 $v_{00}$</li><li>将所有与 $b$ 交为奇数的乘上 $\sqrt{\dfrac{v_{10}v_{11}}{v_{00}v_{01}}}$</li><li>将所有与 $c$ 交为奇数的乘上 $\sqrt{\dfrac{v_{01}v_{11}}{v_{00}v_{10}}}$</li><li>将所有与 $b\oplus c$ 交为奇数的乘上 $\sqrt{\dfrac{v_{01}v_{10}}{v_{00}v_{11}}}$</li></ul><p>这道题的 $v_{ij}$ 都是固定的，因此直接维护系数即可，复杂度 $O(n+2^kk)$</p><h5 id="题解做法"><a href="#题解做法" class="headerlink" title="题解做法"></a>题解做法</h5><p>最后的每一个位置是若干 $x+y+z,x+y-z,x-y+z,x-y-z$ 的乘积</p><p>考虑设这四项的系数分别为 $X,Y,Z,W$，我们对每个位置需要解出这四个数</p><p>首先，有 $X+Y+Z+W=n$</p><p>我们将所有幂级数只有 $b_i$ 的位置设成 $1$，那么对于 fwt 后的位置，$X,Y$ 类的位置被贡献了 $1$，$Z,W$ 的位置被贡献了 $-1$，也就是说如果我们将所有 $n$ 个幂级数的 fwt 加起来，我们就得到了 $X+Y-Z-W$，由于 fwt 是线性运算，所以我们只需要将所有幂级数加起来做一次 fwt</p><p>通过 $c_i$ 可以得到 $X-Y+Z-W$</p><p>通过 $b_i\oplus c_i$ 可以得到 $X-Y-Z+W$</p><p>解一下方程即可求出每一项</p><p>复杂度 $O(2^kk)$</p>
              </div>
            </details>
<hr>
<h3 id="8-CF1750G-Doping-E"><a href="#8-CF1750G-Doping-E" class="headerlink" title="8.  CF1750G - Doping [E]"></a>8.  CF1750G - Doping [E]</h3><h4 id="题面-7"><a href="#题面-7" class="headerlink" title="题面"></a>题面</h4><p>给定长为 $n$ 的排列 $p$，对每个 $t=0,1,\cdots,n-1$，求有多少排列 $p^\prime$ 满足：</p>
<ul>
<li>$p^\prime$ 的字典序小于 $p$</li>
<li>恰好有 $t$ 个 $1\le i&lt;n$ 满足 $p^\prime_i+1=p^\prime_{i+1}$</li>
</ul>
<p>对给定正整数 $m$ 取模</p>
<p>$1\le n\le2000,10\le m\le10^9$</p>
<h4 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>首先考虑得到一个 $O(n^3)$ 做法。</p><p>如果没有字典序限制的话一种很显然的想法就是钦定，那么我们现在枚举 lcp</p><p>设 lcp 为 $i$，现在后缀中我们可以使用一个集合内的数，我们需要算钦定 $j$ 个位置满足 $p^\prime_i+1=p^\prime_{i+1}$ 的方案数 $f_{i,j}$</p><p>直接计算不好算，因此我们不直接钦定位置，而是钦定一些值域段，然后将它们排进去，进行一些分类讨论可以得到一个对每个 $i$ 都为 $O(n^2)$ 的求解方式，优化一下即可变成 $O(n)$</p><p>现在的复杂度瓶颈在于我们需要对每个 $i$ 都做一次二项式反演</p><p>注意到我们在 $f_i$ 的时候没有钦定前面的位置，因此我们可以倒着 dp，给这些已知的位置也加上钦定，那么我们就只用做一次二项式反演即可</p><p>复杂度 $O(n^2)$</p>
              </div>
            </details>
<hr>
<h3 id="9-CF1129E-Legendary-Tree-E"><a href="#9-CF1129E-Legendary-Tree-E" class="headerlink" title="9.  CF1129E - Legendary Tree [E]"></a>9.  CF1129E - Legendary Tree [E]</h3><h4 id="题面-8"><a href="#题面-8" class="headerlink" title="题面"></a>题面</h4><p>交互题。</p>
<p>有一棵隐藏的 $n$ 个节点的树。你可以进行 $11111$ 次询问，每次询问你需要给出两个不交的集合 $S,T$，以及一个节点 $v$，交互库会回答有多少对 $s\in S,t\in T$ 使得 $s$ 到 $t$ 的路径经过 $v$</p>
<p>$2\le n\le500$</p>
<h4 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>我们可以询问 $(\{1\},\{2,3,\cdots,n\},i)$ 得到 $i$ 的子树大小，那么按照子树大小从大到小排序，我们就得到了这棵树的一个拓扑序</p><p>正着直接做需要乱七八糟的点分治。</p><p>考虑倒着扫，那么当前后面的结构会形成若干棵子树，设这些子树的根组成的数组为 $o$，那么询问 $(\{1\},o[L:R],i)$ 就可以得到区间中是否有 $i$ 的儿子，那么我们类似于线段树/二分，每个儿子最多贡献 $O(\log n)$ 次询问，之后这个儿子就会被从 $o$ 中删除，因此总询问次数为 $O(n\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="10-JOISC2017-开荒者-K-✔️"><a href="#10-JOISC2017-开荒者-K-✔️" class="headerlink" title="10.  JOISC2017 - 开荒者 [K] ✔️"></a>10.  JOISC2017 - 开荒者 [K] ✔️</h3><h4 id="题面-9"><a href="#题面-9" class="headerlink" title="题面"></a>题面</h4><p>一个 $R\times C$ 的网格，有 $n$ 个给定格子有草</p>
<p>每年夏天，你可以选择一个方向，让所有草向这个方向扩散一格（之前的草仍被保留）</p>
<p>求最少多少年能让网格填满草</p>
<p>$1\le n\le300,1\le R,C\le10^9$</p>
<h4 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>注意到操作的顺序无关，最后每个草都会被扩展成一个矩形，设上下左右操作次数分别为 $u,d,l,r$</p><p>注意到如果 $u+d,l+r$ 均相等，那么扩散出的图形形状应该是一样的，只不过位置可能不同</p><p>我们期望让这个东西和值域无关，因此我们需要进行一些分析</p><p>考虑对于一组合法解，我们不断缩小 $u,d$，首先缩小 $d$，那么如果不能继续缩小，一定发生了 $d+u=|x_j-x_i|-1$ 或 $x_i+d=R$，$|x_j-x_i|$ 只有 $O(n^2)$ 种，我们接下来只考虑 $x_i+d&lt;R$ 的情况，这种情况下我们继续缩小 $u$，那么依然是 $d+u=|x_j-x_i|-1$ 或 $x_i-u=1$，也就是说如果 $d+u$ 不为某个 $|x_j-x_i|-1$，则必然满足存在 $x_i,x_j$ 使得 $d+u=x_i-1+R-x_j$，也只有 $O(n^2)$ 种</p><p>也就是说总共只有 $O(n^2)$ 种可能的 $u+d$</p><p>此时一种可行的写法是枚举 $u+d$，二分 $l+r$，然后直接判断产生的图形是否能包含一个 $R\times C$ 的矩形，复杂度 $O(n^3\log n)$</p><p>但是其实可以不带 log。</p><p>对于固定的 $u+d$，我们首先假设 $u=0$，每一行会被哪些草影响到已经固定，那么对于一行，设上面的草为 $i_1,i_2,\cdots,i_k$，那么如果最后 $R\times C$ 的矩形包含它，意味着需要满足 $l\ge i_1-1,l+r\ge i_{j+1}-i_j-1,r\ge C-i_k$</p><p>我们按顺序扫这些行，做三个滑动窗口，就可以得到把 $R\times C$ 矩形放在每一个位置的限制</p><p>但是还有未解决的问题：</p><ul><li>对于一行，计算最大的相邻差直接 $O(n)$ 会导致复杂度变为 $O(n^4)$，注意到影响到一行的草一定是按 $x$ 排序后的一个区间，因此我们只用预处理 $O(n^2)$ 个区间，容易做到 $O(n^3)$</li><li>我们进行扫描线需要将操作排序，这个如果我们一开始将所有草按 $x$ 排序，就是两个有序序列的归并，因此也不需要带 log</li></ul><p>那么我们就得到了一个 $O(n^3)$ 做法</p><p>至于为什么选出一个 $R\times C$ 矩形一定意味着找到了答案，不妨假设我们此时固定了 $u+d,l,r$</p><p>找到 $x$ 最小的草 $G$，如果 $R\times C$ 矩形与 $G$ 产生出的矩形不交，那么由于一开始所有草都在 $R\times C$ 矩形内，因此这个矩形内的有草行数一定 $&lt;R$，不合法</p><p>我们将草整体平移，将 $G$ 平移到 $R\times C$ 与 $G$ 的矩形第一次有交的行，每个草依然在原来的矩形内，并且每个草也在 $R\times C$ 矩形的范围内，因此构造合法</p>
              </div>
            </details>
<hr>
<h3 id="11-JOISC2017-港口设施-S"><a href="#11-JOISC2017-港口设施-S" class="headerlink" title="11.  JOISC2017 - 港口设施 [S]"></a>11.  JOISC2017 - 港口设施 [S]</h3><h4 id="题面-10"><a href="#题面-10" class="headerlink" title="题面"></a>题面</h4><p>有 $n$ 个物品和两个栈，每个物品被压入某个栈一次，弹出某个栈一次</p>
<p>给出每个物品被压入和弹出的时刻，保证为 $1\sim 2n$ 的排列</p>
<p>求有多少种选择每个物品压入哪个栈的方案，使得入栈出栈顺序合法，对 $10^9+7$ 取模</p>
<p>$1\le n\le10^6$</p>
<h4 id="题解-10"><a href="#题解-10" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>相当于我们在所有相交不包含的区间之间连边，判断是否有奇环，并且求连通块个数</p><p>相交不包含，这个我们可以用一个类似栈的结构去刻画，那么我们每次对于一个区间的 merge 就是把一段区间内的点全 merge 起来，这个可以用并查集维护</p><p>复杂度 $O(n\alpha(n))$</p>
              </div>
            </details>
<hr>
<h3 id="12-JOISC2017-烟花棒-E"><a href="#12-JOISC2017-烟花棒-E" class="headerlink" title="12.  JOISC2017 - 烟花棒 [E]"></a>12.  JOISC2017 - 烟花棒 [E]</h3><h4 id="题面-11"><a href="#题面-11" class="headerlink" title="题面"></a>题面</h4><p>有 $n$ 个人在数轴上，第 $i$ 个人的位置为 $x_i$，保证 $x$ 递增，每个人手中有一个烟花，每个烟花能燃烧 $T$ 的时间</p>
<p>初始第 $k$ 个人的烟花刚刚被点燃，每个人的最大速度为 $v$，这些人会在数轴上运动，当两个人位置相同时，可以将未点燃的烟花用燃烧着的烟花点燃</p>
<p>求想让所有人的烟花都被点燃过，$v$ 最小应该是多少</p>
<p>$1\le n,k\le10^5$</p>
<h4 id="题解-11"><a href="#题解-11" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>首先，可以二分，那么变成判定性问题。</p><p>一个显然的事情就是两边的人一定向中间运动。</p><p>进一步，我们可以发现一个人到达 $k$ 的位置后，可以让他跟着 $k$ 走，给 $k$ 的烟花续命</p><p>可以说明，如果两个人相遇，将烟花点燃后分开一定不优，因为 $k$ 向一边走，另一边一定跟着 $k$ 走，那么它们之间的距离都不会发生改变，也就是说点燃后分开产生的效果可以被不分开所替代</p><p>那么现在问题就转化为，$k$ 一开始有 $2vT$ 的距离可以走，每一步可以耗费一些距离，选择吃掉左边或者右边的人，得到 $2vT$ 的距离，求是否能吃掉所有人</p><p>计算出来所有收益，从 $k$ 开始向左吃，如果吃到一段之后收益是正的了，那么只要我们某一时刻能吃掉这一段，吃掉了一定不劣，对于右边的段同理</p><p>那么我们每次求出左边和右边的段，每次判断是否能吃掉一个段，能吃就吃掉，否则无解</p><p>最后的结果就是两边继续吃下去收益都是负的</p><p>这种情况下我们从最后的情况出发，从两边向内走，那么此时就和吃人一样了，也就是说我们把刚才的事情倒过来做一遍就可以了</p><p>复杂度 $O(n\log V)$</p>
              </div>
            </details>
<hr>
<h3 id="13-JOISC2017-门票安排-E-⭐"><a href="#13-JOISC2017-门票安排-E-⭐" class="headerlink" title="13.  JOISC2017 - 门票安排 [E] ⭐"></a>13.  JOISC2017 - 门票安排 [E] ⭐</h3><h4 id="题面-12"><a href="#题面-12" class="headerlink" title="题面"></a>题面</h4><p>环上有 $n$ 个点，有 $m$ 组人，第 $i$ 组人有 $c_i$ 个要从 $a_i$ 走到 $b_i$，这些人可以选择两条路中的一条，他们不一定要选择同一条。</p>
<p>这 $n$ 个点之间的 $n$ 条线段，每条会被若干人经过，求这些线段中，经过人数最大值的最小值。</p>
<p>$1\le n\le2\times10^5,1\le m\le10^5,1\le c_i\le10^9$</p>
<h4 id="题解-12"><a href="#题解-12" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>环上不好考虑，从 $1-n$ 断开扔到直线上</p><p>我们先假设所有人选的都是区间，那么改成区间的补会让内部 $-1$，外部 $+1$，这个很丑，所以改成整体 $+1$，内部 $-2$</p><p>那么这个问题瞬间就好做了：我们假设一共用了 $M$ 个补，那么相当于我们可以选择 $M$ 个区间 $-2$，最大值最小</p><p>反过来，相当于我们固定一个最大值 $M$，那么我们需要选择尽量少的 $-2$ 操作，使得最大值 $\le M$</p><p>这个非常贪心，我们从左到右扫，如果当前位置 $&gt;M$ 就选择右端点最大的区间操作</p><p>那么对于所有最大值把答案 $+M$ 取 min 就是最终的答案了。</p><p>注意到对于 $M$ 的同一奇偶，这个东西是凸的，那么加一个二分即可，复杂度 $O(n\log n\log V)$</p><p>至于为什么是凸的。我不会证。但是大致的直觉是：$x$ 到 $x+2$ 的影响是相当于一些位置需要被覆盖的次数 $+1$，而 $x+2$ 到 $x+4$ 的时候 $+1$ 的位置是 $x$ 到 $x+2$ 时的超集，并且能选择的区间越来越少，所以差分越来越大</p>
              </div>
            </details>
<hr>
<h3 id="14-JOISC2017-火车旅行-S"><a href="#14-JOISC2017-火车旅行-S" class="headerlink" title="14.  JOISC2017 - 火车旅行 [S]"></a>14.  JOISC2017 - 火车旅行 [S]</h3><h4 id="题面-13"><a href="#题面-13" class="headerlink" title="题面"></a>题面</h4><p>数轴上有 $n$ 个点，第 $i$ 个点的高度为 $a_i\in[1,k]$，保证 $a_1=a_n=k$</p>
<p>假设你当前在 $x$，每步你可以选定一个值 $v$，然后移动到 $x$ 左边或右边第一个 $\ge v$ 的下标</p>
<p>$q$ 次询问，每次给定一个起点和终点，求两点间最短路</p>
<p>$2\le n\le10^5$</p>
<h4 id="题解-13"><a href="#题解-13" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p class='h5' id="Flamire-做法"><a href="#Flamire-做法" class="headerlink" title="Flamire 做法"></a>Flamire 做法</h5><p>考虑最值分治：找到当前区间内最大的 $a_i$，对于两边的每个点，维护 $f_i$ 表示从 $i$ 到区间左边的最短路，$g_i$ 表示 $i$ 到区间右边的最短路，合并两个区间时我们需要进行的就是一个 2x2 的区间 $(min,+)$ 矩乘，用线段树维护即可，复杂度 $O(n\log n)$</p><h5 id="题解做法"><a href="#题解做法" class="headerlink" title="题解做法"></a>题解做法</h5><p>考虑倍增：容易发现起点和终点只要都到达中间的最大值即可</p><p>那么我们倍增维护出起点和终点分别跳 $2^j$ 步后能到区间即可</p><p>复杂度 $O(n\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="15-CF1909I-Short-Permutation-Problem-K"><a href="#15-CF1909I-Short-Permutation-Problem-K" class="headerlink" title="15.  CF1909I - Short Permutation Problem [K]"></a>15.  CF1909I - Short Permutation Problem [K]</h3><h4 id="题面-14"><a href="#题面-14" class="headerlink" title="题面"></a>题面</h4><p>给定 $n$，对每对 $m,k(3\le m\le n+1,0\le k&lt;n)$，求出有多少排列 $p$ 满足 $p_i+p_{i+1}\ge m$ 的个数恰好为 $k$，对 $998244353$ 取模</p>
<p>$1\le n\le4000$</p>
<h4 id="题解-14"><a href="#题解-14" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>经典套路，转化成逐个加数，按 $[m/2,m/2+1,m/2-1,m/2+2,\cdots]$ 的顺序加数，容易发现每个数旁边的两个只和新加的数的类型有关</p><p>令 $dp_{i,j}$ 表示当前加入了前 $i$ 个数，有 $j$ 对合法相邻元素，转移是容易的，我们得到了一个 $O(n^3)$ 的做法</p><p>我们转化成 $\le m$ 考虑，这样对于每个 $m$ 我们加入的数一定先是大小交错，后全是大数，前面的部分对于所有 $m$ 都是一样的，后面的大数部分可以写成组合数的形式，然后使用 ntt 优化，复杂度 $O(n^2\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="16-CF1909H-Parallel-Swaps-Sort-E"><a href="#16-CF1909H-Parallel-Swaps-Sort-E" class="headerlink" title="16.  CF1909H - Parallel Swaps Sort [E]"></a>16.  CF1909H - Parallel Swaps Sort [E]</h3><h4 id="题面-15"><a href="#题面-15" class="headerlink" title="题面"></a>题面</h4><p>给定 $1\sim n$ 的排列 $a_1,a_2,\cdots,a_n$，你需要进行如下操作若干次，将 $a$ 排序：</p>
<ul>
<li>选定区间长度为偶数的区间 $[l,r]$，交换 $(a_l,a_{l+1}),(a_{l+2},a_{l+3}),\cdots,(a_{r-1},a_r)$</li>
</ul>
<p>你最多进行 $10^6$，请构造一种操作序列</p>
<p>$1\le n\le3\times10^5$</p>
<h4 id="题解-15"><a href="#题解-15" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p class='h5' id="Flamire-做法"><a href="#Flamire-做法" class="headerlink" title="Flamire 做法"></a>Flamire 做法</h5><p>经过若干次手模，可以发现每次好像换最前面的一段都满足 $a_i&gt;a_{i+1}$ 的区间很优</p><p>我们规范一下这个过程，维护一个前缀 $I$，$I$ 不断变长，每次新加进来一个数将其查到前面有序的位置中</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">16 3 4 11 12 6 5 15 10 8 14 13 1 2 9 7</span><br><span class="line">3 16 4 11 12 6 5 15 10 8 14 13 1 2 9 7</span><br><span class="line">3 4 16 11 12 6 5 15 10 8 14 13 1 2 9 7</span><br><span class="line">3 4 11 16 12 6 5 15 10 8 14 13 1 2 9 7</span><br><span class="line">3 4 11 12 16 6 5 15 10 8 14 13 1 2 9 7</span><br><span class="line">3 4 11 12 6 16 5 15 10 8 14 13 1 2 9 7</span><br><span class="line">3 4 11 6 12 5 16 15 10 8 14 13 1 2 9 7</span><br><span class="line">3 4 6 11 5 12 15 16 10 8 14 13 1 2 9 7</span><br><span class="line">3 4 6 11 5 12 15 10 16 8 14 13 1 2 9 7</span><br><span class="line">3 4 6 11 5 12 10 15 8 16 14 13 1 2 9 7</span><br><span class="line">3 4 6 5 11 10 12 8 15 14 16 13 1 2 9 7</span><br><span class="line">3 4 5 6 10 11 8 12 14 15 13 16 1 2 9 7</span><br><span class="line">3 4 5 6 10 11 8 12 14 13 15 1 16 2 9 7</span><br><span class="line">3 4 5 6 10 11 8 12 13 14 1 15 2 16 9 7</span><br><span class="line">3 4 5 6 10 11 8 12 13 1 14 2 15 9 16 7</span><br><span class="line">3 4 5 6 10 11 8 12 1 13 2 14 9 15 7 16</span><br><span class="line">3 4 5 6 10 8 11 1 12 2 13 9 14 7 15 16</span><br><span class="line">3 4 5 6 8 10 1 11 2 12 9 13 7 14 15 16</span><br><span class="line">3 4 5 6 8 1 10 2 11 9 12 7 13 14 15 16</span><br><span class="line">3 4 5 6 1 8 2 10 9 11 7 12 13 14 15 16</span><br><span class="line">3 4 5 1 6 2 8 9 10 7 11 12 13 14 15 16</span><br><span class="line">3 4 5 1 6 2 8 9 7 10 11 12 13 14 15 16</span><br><span class="line">3 4 5 1 6 2 8 7 9 10 11 12 13 14 15 16</span><br><span class="line">3 4 1 5 2 6 7 8 9 10 11 12 13 14 15 16</span><br><span class="line">3 1 4 2 5 6 7 8 9 10 11 12 13 14 15 16</span><br><span class="line">1 3 2 4 5 6 7 8 9 10 11 12 13 14 15 16</span><br><span class="line">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16</span><br></pre></td></tr></table></figure></div><p>用平衡树维护每个数到达有序位置的时间</p><p>复杂度 $O(n\log n)$</p><h5 id="zak-做法"><a href="#zak-做法" class="headerlink" title="zak 做法"></a>zak 做法</h5><p>考虑反转排列的操作：这个是容易构造的，不断操作 $(1,n)$ 和 $(2,n-1)$ （或 $(1,n-1)$ 和 $(2,n)$）</p><p>反转排列的操作中，每对数恰好相邻了一次，那么我们在这时交换两个数，它们最后到的位置也会交换，相当于我们以某种顺序给定了这 $\frac12n(n-1)$ 个数对，每一步可以选择是否交换它们</p><p>而我们是可以交换出任意排列的，如果两个相邻数属于同一个置换环就交换，最后任意两个都不属于同一个置换环，因此可以得到 $1,2,\cdots,n$，并且生效的操作数最多 $n-1$ 次</p><p>那么我们就得到了一个 $O(n^2)$，操作次数 $2n-1$ 的做法，考虑优化</p><p>应该观察一下矩阵的性质啥的？？我不知道啊。总之似乎是可以维护的</p>
              </div>
            </details>
<hr>
<h3 id="17-CF1965F-Conference-K-⭐"><a href="#17-CF1965F-Conference-K-⭐" class="headerlink" title="17.  CF1965F - Conference [K] ⭐"></a>17.  CF1965F - Conference [K] ⭐</h3><h4 id="题面-16"><a href="#题面-16" class="headerlink" title="题面"></a>题面</h4><p>有 $n$ 个人，第 $i$ 个人可以安排在第 $[l_i,r_i]$ 天演讲</p>
<p>你需要选择 $k$ 个连续的天，使得存在一种将人和天的匹配方式，使得每个天都被匹配上</p>
<p>对 $k=1,2,\cdots,n$，求有多少选择连续 $k$ 天的方式满足条件</p>
<p>$1\le n\le2\times10^5,1\le l_i,r_i\le2\times 10^5$</p>
<h4 id="题解-16"><a href="#题解-16" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>首先，这个问题可以 two-pointers，那么我们需要解决的问题就是如何判断一个区间是否合法</p><p>这是一个区间图匹配问题，贪心方法显然不好扩展，因此考虑 Hall 定理</p><p>由于天数是完美匹配，所以我们可以考虑以人为 $N(S)$，以区间为 $S$，一种简单的想法是只考虑 $S$ 为区间的情况，但这是错误的，反例容易构造</p><p>考虑观察一些性质：对于两个人 $[a,b],[a,c]$，其中 $a\le b\le c$，那么我们把 $[a,c]$ 改为 $[a+1,c]$ 并不会影响答案，如果调整出空区间就将这个人扔掉</p><p>注意到这样调整之后所有人的 $l$ 一定互不相同，可以发现（？）现在我们只考虑所有 $S$ 为区间的情况就够了，因为如果 $x,y\in S,[x+1,y-1]\not\in S$，那么加上 $[x+1,y-1]$ 中的所有元素后，$|N(S)|$ 的增加量一定小于等于 $S$ 的增加量</p><p>但是所有区间还不是很好判，继续观察性质：我们对右端点 $r$ 做同样的处理，而 $r$ 互不相同的情况下，如果 $[l,r]$ 非法，那么 $[l-1,r]$ 和 $[l,r+1]$ 一定也非法</p><p>考虑 $l$ 扩展到 $l-1$ 发生的事情：$|N(S)|$ 增加量 $\le 1$，$|S|$ 增加量 $=1$</p><p>那么相当于我们只用判整个区间是否合法，two-pointers $O(n)$ 维护即可</p>
              </div>
            </details>
<hr>
<h3 id="18-CF1930G-Prefix-Max-Set-Counting-E-⭐"><a href="#18-CF1930G-Prefix-Max-Set-Counting-E-⭐" class="headerlink" title="18.  CF1930G - Prefix Max Set Counting [E] ⭐"></a>18.  CF1930G - Prefix Max Set Counting [E] ⭐</h3><h4 id="题面-17"><a href="#题面-17" class="headerlink" title="题面"></a>题面</h4><p>给定一棵根为 $1$ 的 $n$ 个点的树</p>
<p>求所有 dfs 序能生成的编号前缀最大值集合的数量，对 $998244353$ 取模</p>
<p>$1\le n\le10^6$</p>
<h4 id="题解-17"><a href="#题解-17" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>考虑一个点的所有儿子，不妨将其按子树最大值 $mx$ 排序</p><p>注意到如果我们先访问了 $mx_{v2}&gt;mx_{v1}$，那么 $v1$ 一定不会再对答案造成贡献了，这意味着我们可以将这个过程视作选择一些 $mx$ 递增的子树访问（最大的子树必须选），剩下的丢弃掉</p><p>再进行一些观察：如果访问子树 $v$ 的时候，前面的最大值 $&gt;mx_v$，那么 $v$ 一定不会有任何作用，否则出这个子树的时候前面的最大值一定为 $mx_v$</p><p>现在访问顺序固定了，那么我们可以进行一个过程，不断计算出到一个点 $u$ 之前最大值为 $j$ 的路径为多少，搜进一棵子树的时候，这棵子树要么不选，要么会把所有 $&lt;mx_v$ 的值全贡献到 $mx_v$，也就是说最后的结果就是 $mx_u$ 的位置上加上了某个值</p><p>在进入一个节点 $u$ 时我们需要将前缀的值全部赋 $0$，然后单点加到某一个点上，再对每个子树对应的位置上加上值，最后比较一下 $mx_u$ 位置的值和一开始的值，然后将所有操作撤回</p><p>注意到全部赋 $0$ 操作后赋 $0$ 的区间不会再被使用，所以我们其实根本不用赋 $0$，那么剩下的部分用树状数组维护即可</p><p>复杂度 $O(n\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="19-CF1817F-Entangled-Substrings-E"><a href="#19-CF1817F-Entangled-Substrings-E" class="headerlink" title="19.  CF1817F - Entangled Substrings [E]"></a>19.  CF1817F - Entangled Substrings [E]</h3><h4 id="题面-18"><a href="#题面-18" class="headerlink" title="题面"></a>题面</h4><p>给定一个字符串 $s$，求非空子串对 $(a,b)$ 的对数，满足存在一个字符串（可空）$c$ 使得 $a,b$ 所有在 $s$ 中的出现都形如 $acb$</p>
<p>$1\le|s|\le10^5$</p>
<h4 id="题解-18"><a href="#题解-18" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>题解有厉害基本子串结构，但是我不会。</p><p>不过这是纯纯的唐氏题。</p><p>考虑用熟悉的事情改写 $(a,b)$ 的限制，注意到 $a,b,c$ endpos 差分都必须相同，且 $b,c$ 属于同一个 sam 节点</p><p>endpos 差分可以用哈希判，因此我们只用考虑一个等价类内的 sam 节点。</p><p>对于一个 $b,c$ 的 sam 节点 $u$，考虑如何计数 $(a,b,c)$ 对数，设串 $x$ 的第一次出现位置为 $[l(x),r(x)]$，那么需要满足的是 $l(a)=l(c),r(a)&lt;l(b)$</p><p>那么我们如果固定 $a,u$，$c$ 也只有一种选法，而 $b$ 只要满足左端点比 $r(a)$ 靠后，也就是 $r(a)$ 到 $mn(u)-len(fail(u))+1$ 的距离种选法</p><p>也就是说，对于第一次出现在 $[mn(u)-len(u)+1,mn(u)-len(fail(u))]$ 内的所有串 $a$，它会贡献到右端点距离的方案数，这可以用线段树+扫描线维护</p><p>复杂度 $O(n\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="20-CF1738H-Palindrome-Addict-E"><a href="#20-CF1738H-Palindrome-Addict-E" class="headerlink" title="20.  CF1738H - Palindrome Addict [E]"></a>20.  CF1738H - Palindrome Addict [E]</h3><h4 id="题面-19"><a href="#题面-19" class="headerlink" title="题面"></a>题面</h4><p>你有一个字符串 $s$，初始为空，有 $q$ 次操作：</p>
<ul>
<li><code>push c</code>，在 $s$ 末尾接上一个字符 $c$</li>
<li><code>pop</code>，删除 $s$ 的第一个字符</li>
</ul>
<p>每次操作后求 $s$ 的本质不同回文子串个数</p>
<p>$1\le q\le10^6$</p>
<h4 id="题解-19"><a href="#题解-19" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p class='h5' id="Flamire-做法"><a href="#Flamire-做法" class="headerlink" title="Flamire 做法"></a>Flamire 做法</h5><p>建 PAM，注意到每次 <code>push</code> 和 <code>pop</code> 分别会让一些回文串的出现次数 +1/-1，并且操作的范围都是某个节点的到根链</p><p>这个节点可以用倍增求出，用 ds 维护可以做到 $O(q\log^2q)$ 或 $O(q\log q)$</p><h5 id="题解做法"><a href="#题解做法" class="headerlink" title="题解做法"></a>题解做法</h5><p>考虑发现一些性质：每次加入一个字符或删除一个字符，最多导致本质回文子串个数变化 1，因此可以考虑一些均摊复杂度的做法</p><p>加入一个字符的时候判断是否出现新的回文子串是容易的，只要检查一下右端点指针指向的节点是否出现过即可</p><p>那么我们只需要找到需要被删除的节点，就可以在此基础上解决这个问题</p><p>直接找到比较困难，因此我们考虑维护所有已经出现的串的最右出现位置 $pos$，那么所有 $L=i$ 的串会在删除 $s_i$ 的时候消失掉，我们对每个 $L$ 开一个 vector $v_L$，记录左端点为 $L$ 的串，加入一个字符时更新到根链上的所有串的 $pos$，并 $pos-len+1$ 处记录每个串，那么我们从左扫到这个位置时只需要遍历 $v_i$ 内的元素即可</p><p>但是暴力更新复杂度是错的，因此我们采用懒标记的方式：当一个点被删除时，将节点上的 $pos$ 标记上传给父亲，同时我们并没有必要从 $v_L$ 中移除元素，只要判断一下当前 $v_L$ 中的串是否可以被删除即可</p><p>注意到有可能出现儿子的 $pos$ 还没有传上来的情况，这种情况下当前串一定不能删除，因此我们需要额外记录一个 $deg_u$，表示 $u$ 有多少儿子没有被删除</p><p>复杂度 $O(q)$</p>
              </div>
            </details>
<hr>
<h3 id="21-AT-dwacon5th-prelims-e-Cyclic-GCDs-E"><a href="#21-AT-dwacon5th-prelims-e-Cyclic-GCDs-E" class="headerlink" title="21.  AT_dwacon5th_prelims_e Cyclic GCDs [E]"></a>21.  AT_dwacon5th_prelims_e Cyclic GCDs [E]</h3><h4 id="题面-20"><a href="#题面-20" class="headerlink" title="题面"></a>题面</h4><p>给定长为 $n$ 的序列 $a_1,a_2,\cdots,a_n$，对于一个 $1\sim n$ 的排列 $p$，定义其权值为每个环上的 $a$ 值最小值的乘积</p>
<p>定义 $w_i$ 为所有有 $i$ 个环的 $1\sim n$ 排列的 $f(p)$ 之和，求 $\gcd(w_1,w_2,\cdots,w_n)$，对 $998244353$ 取模</p>
<p>$1\le n\le10^5,1\le a_i\le10^9$</p>
<h4 id="题解-20"><a href="#题解-20" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>注意到可以有一个 dp 解法算所有的 $w_i$：令 $dp_{i,j}$ 表示插入了前 $i$ 小的数，现在形成了 $j$ 个环，转移是 $a_{i+1}\times dp_{i,j}\rightarrow dp_{i+1,j+1}$ 和 $i\times dp_{i,j}\rightarrow dp_{i+1,j}$</p><p>也就是说 $w$ 就是 $\prod(a_ix+i-1)$ 的各项系数</p><p>打表发现答案看起来像是各种东西乘出来的，大胆猜测一下答案是 $\prod\gcd(a_i,i-1)$，发现对上了</p><p>事实上，我们可以证明这件事情：设 $P,Q$ 为两个多项式，且 $c(P),c(Q)$ 表示 $P,Q$ 各项系数的 $\gcd$，那么 $c(P\times Q)=c(P)\times c(Q)$</p><p>不妨设 $c(P)=c(Q)=1$，我们证明此时 $c(PQ)=1$ 就相当于证明了原命题</p><p>不妨假设某质数 $p$ 满足 $p|c(PQ)$，那么 $P$ 的最高位与 $Q$ 的最高位一定有一个 $p$ 的倍数，不妨设是 $P$ 的最高位，那么我们将 $P$ 的最高位去除，得到 $P^\prime$，$P$ 的最高位对系数产生的贡献一定是 $p$ 的倍数，不影响模 $p$ 的余数，因此 $p|c(P^\prime Q)$ 依然需要成立</p><p>最后可以规约到 $P,Q$ 只剩常数项的情况，此时更高次项一定都是 $p$ 的倍数，而 $P,Q$ 的常数项至少有一个是 $p$ 的倍数，矛盾</p><p>一种直观的理解方式是 $P,Q$ 在模 $p$ 意义下均非零，而 $PQ$ 在模 $p$ 意义下为 $0$，这个显然不合理</p>
              </div>
            </details>
<hr>
<h3 id="22-CF1394E-Boboniu-and-Banknote-Collection-E-✔️"><a href="#22-CF1394E-Boboniu-and-Banknote-Collection-E-✔️" class="headerlink" title="22.  CF1394E - Boboniu and Banknote Collection [E] ✔️"></a>22.  CF1394E - Boboniu and Banknote Collection [E] ✔️</h3><h4 id="题面-21"><a href="#题面-21" class="headerlink" title="题面"></a>题面</h4><p>给定一个长为 $n$ 的数组 $a_1,a_2,\cdots,a_n$，对每个前缀求最多折多少次（要求对应位置相等）</p>
<p>$1\le n\le10^5,1\le a_i\le n$</p>
<h4 id="题解-21"><a href="#题解-21" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>以下均认为回文串指的是偶回文串</p><p>对于 $A+\textrm{rev}(A)+A$ 的串，我们称其为 $Z$ 串，那么我们的操作有两种：折掉一个回文前缀/后缀 或者 折掉一个 $Z$ 串</p><p>如果我们一次操作内折掉了一个不是最小的回文前缀/后缀，不难发现这是不优的，因为我们折最小的前后缀可以用更多次操作完成同样的事情，那么这限制我们，每次折的回文串都不能有更短的回文前后缀</p><p>如果两个回文串互相覆盖对方的中心，那么一定能产生一个 $Z$ 串，同时这也是 $Z$ 串的充要条件</p><p>定义所有不包含 $Z$ 串作为子串的 $Z$ 串为本原 $Z$ 串，那么可以发现本原 $Z$ 串的一定有唯一的回文后缀恰好取在 $\textrm{rev}(A)+A$ 的位置（否则不是本原 $Z$ 串），也就是说最后的方案里 $A$ 和 $\textrm{rev}(A)$ 的内部不会有折叠点</p><p>定义 $f(s)$ 为串 $s$ 的答案，那么我们说明 $f(B+A+\text{rev}(A)+A+C)=f(B+A+C)+2$，左边 $\ge$ 右边是好说的，考虑说明左边 $\le$ 右边，考察 $A+\text{rev}(A)+A$ 内部有多少折点</p><ul><li>有两个折点，可以直接规约到 $B+A+C$ 的问题，满足条件</li><li>没有折点，那么最后操作完的串一定包含 $A+\text{rev}(A)+A$，因此一定可以再接着折，增加操作次数</li><li>有一个折点，不妨设是折成 →→← 的样子，那么如果下一段是 ←，我们可以将 →← 段删除，得到一个折点数不变的 $B+A+C$ 的方案，如果下一段是 →，我们可以将 →← 段删除，得到一个折点数 $-2$ 的 $B+A+C$ 的方案</li></ul><p>那么也就是说，对于任意一个本原 $Z$ 串，直接将它折掉对答案没有影响。</p><p>由于本原 $Z$ 串的性质，加入字符时最多只会产生一个本原 $Z$ 串，该串以新字符为结尾，并且我们直接查询以新字符结尾的最短回文后缀就可以得到该 $Z$ 串的长度，然后再查一下 $i-\frac12len$ 位置的最短回文后缀，判一下长度是否相等即可</p><p>那么如果我们能建出 pam，这件事情就是可以办到的。但是最后得到的是一棵字典树，pam 的均摊复杂度不对，这件事情我们稍后处理。</p><p>接下来考虑合并回文前缀/后缀的情况。</p><p>注意到现在我们的字符串没有本原 $Z$ 串，可以发现我们折的回文串长度一定是单峰的，那么我们拆成两个过程来考虑，一个不断折最短回文前缀，一个不断折最短回文后缀</p><p>分析一下，这两个过程大致不会相交，因为我们取出左边最后一个回文串，讨论一下右边第一次跨过来的位置，会发现一定导致两个回文串互相覆盖中心，也就产生了 $Z$ 串，矛盾</p><p>唯一相交的情况就是两个过程缩了同一个回文串的两半，比如 <code>1 1 2 3 3 2 1 1 2</code>，这种情况下特判一下就好</p><p>对于折后缀，我们在字典树上直接向上指，递推即可</p><p>对于折前缀，我们可以维护一个栈，每次新加一个节点的时候判断一下到栈内上一个节点的位置是否是一个回文串，是的话就折掉，回溯的时候只要把范围超掉的弹了就好</p><p>那么如果我们能建出 pam，这件事情就是可以办到的。</p><p>接下来考虑分析建 pam。</p><p>存在不均摊建 pam 的方法，但是我做的时候不会。</p><p>考虑观察一下这题的性质：本原 $Z$ 串的限制很苛刻，一个串看起来不能有重复很多次的周期</p><p>事实上，我们可以证明，一个回文串的最长回文后缀一定 $\le$ 其长度的 $\frac12$，否则它们会互相覆盖中心，产生 $Z$ 串</p><p>那么 pam 的深度是 $O(\log n)$ 的。因此上面那些操作直接暴力，复杂度就是 $O(n\log n)$ 的。</p>
              </div>
            </details>
<hr>
<h3 id="23-CF1098F-Ж-function-K"><a href="#23-CF1098F-Ж-function-K" class="headerlink" title="23.  CF1098F - Ж-function [K]"></a>23.  CF1098F - Ж-function [K]</h3><h4 id="题面-22"><a href="#题面-22" class="headerlink" title="题面"></a>题面</h4><p>给定长为 $n$ 的字符串 $s$，$q$ 次询问，每次询问给定 $l,r$，查询 $\sum_{i=l}^r\text{LCP}(s[l:r],s[i:r])$</p>
<p>$1\le n\le2\times10^5,1\le q\le2\times10^5$</p>
<h4 id="题解-22"><a href="#题解-22" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>建 sa，去除一些容易统计的贡献，问题可以转变为我们需要对所有 $l\le i$，求 $\min(i+w-1,r)$，其中 $w$ 是 $\text{LCA}(i,l)$ 的长度</p><p>用 dsu on tree 难以维护，注意到 $\text{LCA}$ 也是路径信息，因此可以使用点分治来维护。</p><p>分三种情况讨论：</p><ul><li>$l,i$ 在分治中心不同的子树，此时 $w$ 为分治中心</li><li>$l$ 在分治中心子树外，$i$ 在分治中心内，此时 $w$ 与 $l$ 绑定</li><li>$i$ 在分治中心子树外，$l$ 在分治中心内，此时 $w$ 与 $i$ 绑定</li></ul><p>每种情况可以变成二维数点或一维数点问题，可以用树状数组解决，复杂度 $O(n\log^2n)$</p>
              </div>
            </details>
<hr>
<h3 id="24-AGC067B-Modifications-K-✔️"><a href="#24-AGC067B-Modifications-K-✔️" class="headerlink" title="24.  AGC067B - Modifications [K] ✔️"></a>24.  AGC067B - Modifications [K] ✔️</h3><h4 id="题面-23"><a href="#题面-23" class="headerlink" title="题面"></a>题面</h4><p>有初始全 $0$ 的序列 $a_1,a_2,\cdots,a_n$，有 $m$ 个区间 $[l_i,r_i]$，你需要选给每个区间选择一个值 $w_i\in[1,C]$，然后选定一个顺序，依次执行区间覆盖操作</p>
<p>求可能生成的 $a$ 种数，对 $998244353$ 取模</p>
<p>$1\le n\le100,1\le m\le\frac12n(n+1)$，保证 $a$ 中所有位置都被至少一个区间覆盖</p>
<h4 id="题解-23"><a href="#题解-23" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>先考虑如何判断一个 $a$ 是否合法，正着做不好做，因此我们考虑倒过来：那么我们的操作就是每次选择一个不任意元素都相等的区间，然后将这个区间全标记为任意，如果最后能全变为任意，那么 $a$ 就合法</p><p>那么考虑对这个进行 dp，令 $f_{i,j}$ 表示区间 $[i,j]$ 合法的方案数，直接计算不好做，因此我们考虑容斥</p><p>如果一个区间不能变为全任意，那么我们找到所有能变为全任意的极大区间，需要保证的就是这些区间无法继续扩展</p><p>注意到区间无法继续扩展等价于任意一个询问区间要么全任意，要么只包含一种不任意的数，那么我们令 $g_{l,r,k}$ 表示区间 $[l,r]$ 无法变为任意，并且倒数第二个不同的数（即与 $a_r$ 不同的数）是 $k$</p><p>转移即可，复杂度 $O(n^4)$</p>
              </div>
            </details>
<hr>
<h3 id="25-AGC067D-Unique-Matching-E-✔️"><a href="#25-AGC067D-Unique-Matching-E-✔️" class="headerlink" title="25.  AGC067D - Unique Matching [E] ✔️"></a>25.  AGC067D - Unique Matching [E] ✔️</h3><h4 id="题面-24"><a href="#题面-24" class="headerlink" title="题面"></a>题面</h4><p>给定 $n$，求有多少区间序列 $[l_i,r_i]$ 满足 $1\le l_i\le r_i\le n$，且 $\forall a_i\in[l_i,r_i]$ 的条件能唯一确定一个 $1\sim n$ 的排列 $a$，对给定质数 $p$ 取模</p>
<p>$2\le n\le5000$</p>
<h4 id="题解-24"><a href="#题解-24" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>不妨假设最后确定出来是 $p_i=i$，最后乘 $n!$ 即可</p><p>如果我们将 $[l_i,r_i]$ 内除了 $i$ 以外的所有点连向 $i$，那么连出来的图应该是 dag，因此我们考虑一些 dag 计数相关</p><p>考虑处理出度为 $0$ 的点，即所有没有被区间覆盖的点</p><p>设 $f_i$ 表示长为 $i$ 的序列的答案，那么我们枚举最后一个没被覆盖的位置，我们转移需要知道的就是以下两个东西：</p><ul><li>长为 $i$，固定 $1$ 不被覆盖，其余随意的方案数 $H(i)$</li><li>长为 $i$，固定 $1$ 不被覆盖，其余全被覆盖的方案数 $h_i$</li></ul><p>转移式是 $f_j=\sum_{j=1}^iH(j)h_{i-j+1}$</p><p>经过一些分析可以得到 $H(i)=f_{i-1}\times i$，那么我们只用考虑如何求 $h_i$</p><p>考虑容斥，总方案数是 $H(i)$，依然是枚举最后一个没被覆盖的位置，我们转移需要的是：</p><ul><li>长为 $i$，固定 $1$ 和 $i$ 不被覆盖，其余随意的方案数 $G(i)$</li></ul><p>转移式 $h_i=H(i)-\sum_{j=2}^iG(j)h_{i-j+1}$</p><p>经过同样的分析可以得到 $G(i)=f_{i-2}\times(i-1)^2$</p><p>那么直接写出来就是 $O(n^2)$ 的</p>
              </div>
            </details>
<hr>
<h3 id="26-NOI2023-合并书本-K-✔️"><a href="#26-NOI2023-合并书本-K-✔️" class="headerlink" title="26.  NOI2023 - 合并书本 [K] ✔️"></a>26.  NOI2023 - 合并书本 [K] ✔️</h3><h4 id="题面-25"><a href="#题面-25" class="headerlink" title="题面"></a>题面</h4><p>有 $n$ 本书，重量依次是 $w_1,w_2,\cdots,w_n$，磨损值为 $c_i=1$</p>
<p>你每次可以选择两本书 $i,j$，合并得到的新书 $w=w_i+w_j,c=2\max(c_i,c_j)+1$，耗费 $w_i+c_i+c_j$ 的代价</p>
<p>求将所有书合并到一起的最小总代价</p>
<p>$t$ 组数据</p>
<p>$1\le t\le10,1\le n\le100,1\le w_i\le10^9$</p>
<h4 id="题解-25"><a href="#题解-25" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>搜索。完全不会啊。</p><p>注意到最后会搜出一棵合并树，每个非叶子节点表示合并两本书，并且又右儿子贡献 $w_i$，合并树会有一个自带的磨损值代价 $s$，以及每个叶子会有一个 $w$ 被贡献次数 $c_i$，最后算答案就是把 $a$ 排序和 $w$ 点乘，那么考虑搜索出所有的合并树</p><p>如果我们能只关心叶子的 $c_i$ 和整体的 $s$，那么状态数看起来会少一些</p><p>考虑从上到下搜索决策树，每次将决策树的一些叶子分裂成两个叶子，但是这样还是无法计算 $s$ 的变化量</p><p>于是有人说，考虑最后的合并树，设子树高度为 $h_i$，扫 $d=n,n-1,\cdots,1$，从只有一个根的树开始，每次将所有 $h_i=d$ 的节点全部分裂，这样每次分裂后所有非叶子节点当前的子树高度都会 $+1$，那么 $s\leftarrow 2s+\text{非根非叶子节点数}+\text{本次分裂叶子数}$，可以计算</p><p>注意到我们可以直接等效成一次分裂一个子集的叶子，因为我们做的事情是所有非叶子节点子树高度 $+1$，不符合条件的方案权值一定会被算大</p><p>注意到这个子集一定是 $c_i$ 的一个前缀，因为在任意子集的前提下，显然这样是更优的。</p><p>题解说这样直接写出来可以获得 75pts。</p><p>再加一个优化：对一个状态记录 $lim$ 表示转移过来的上一步分裂的叶子数的最小值，由于任意最优操作一定满足分裂的叶子越来越多，那么我们限制一个状态至少分裂 $lim$ 个叶子</p><p>加上这个优化后总状态数只有 $&lt;50000$ 多个状态，可以通过（因为每个测试点只用跑一次预处理，对于 $t$ 组数据暴力 check 一遍所有状态即可）</p>
              </div>
            </details>
<hr>
<h3 id="27-UNR8-里外一致-K-⭐"><a href="#27-UNR8-里外一致-K-⭐" class="headerlink" title="27.  UNR8 - 里外一致 [K] ⭐"></a>27.  UNR8 - 里外一致 [K] ⭐</h3><h4 id="题面-26"><a href="#题面-26" class="headerlink" title="题面"></a>题面</h4><p>给定长为 $n$ 的序列 $a_1,a_2,\cdots,a_n$，$q$ 次询问，每次给定一个区间 $[l,r]$，求有多少不同的 $[l,r]$ 内的下标集合 $S$ 使得下标在 $S$ 内的位置的 $a$ 值种数等于下标在 $[l,r]-S$ 内的位置的 $a$ 值种数，对 $2^{64}$ 取模</p>
<p>$1\le n\le3\times10^5,1\le q\le10^5,1\le a_i\le n$</p>
<h4 id="题解-26"><a href="#题解-26" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>火大了。</p><p>注意到对于一个 $[l,r]$ 内出现次数为 $w$ 的数，其有 $1$ 的方案使 $S$ 内种数减去 $S$ 外种数 $+1$，$1$ 的方案使 $S$ 内种数减去 $S$ 外种数 $-1$，$2^w-2$ 种方案使差不变</p><p>也就是 $(x^{-1}+x+2^w-2)$，乘一个 $x$ 变成 $(1+(2^w-2)x+x^2)$，最后求的就是所有乘起来后的 $x^m$ 的系数（$m$ 为 $[l,r]$ 中不同数种数）</p><p>注意到模数是 $2^{64}$，因此可以将 $w$ 对 $2^{64}$ 取 $\min$。</p><p>现在如果直接枚举取了多少项 $2^w-2$ 只能得到 $64^3$ 的做法，不是很牛。</p><p>注意到 $2^w$ 其实非常好，而 $2^w-2$ 就没那么好，因此我们考虑拆出来 $2^w$，也就是把原来拆成 $(x-1)^2+2^wx$，这样我们枚举取了多少个 $2^wx$ 后外面的系数也是好算的</p><p>此时外面倒着 dp，$dp_{i,j}$ 表示出现次数 $\ge i$ 的，一共选了 $j$ 项 $2^wx$ 的系数，注意到 $ij\le64$，根据 $\sum(\frac{64}i)^2=O(64^2)$，所以总复杂度是 $O(q\cdot64^2)$ 的</p><p>算出每种出现次数有多少数可以使用莫队或扫描线，复杂度 $O(n\sqrt q)$ 或 $O(64\cdot n\log n)$</p>
              </div>
            </details>
<hr>
<h3 id="28-UNR8-二维抄袭检测-E-✔️"><a href="#28-UNR8-二维抄袭检测-E-✔️" class="headerlink" title="28.  UNR8 - 二维抄袭检测 [E] ✔️"></a>28.  UNR8 - 二维抄袭检测 [E] ✔️</h3><h4 id="题面-27"><a href="#题面-27" class="headerlink" title="题面"></a>题面</h4><p>给定一个字符串 $s$ 以及一个 $n\times m$ 的字符矩阵 $t$，$q$ 次询问，每次给定 $i,j,p$，询问：</p>
<ul>
<li>从 $t_{i,j}$ 开始向下或向右走能走出来的与 $s[p:]$ 匹配的最长路径的长度</li>
</ul>
<p>$1\le|s|,q\le10^6,1\le n\le10,1\le m\le5\times10^4$</p>
<h4 id="题解-27"><a href="#题解-27" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>路径的形态不好考虑，因此我们先考虑一些愚蠢的策略，比如一直向右走，这是两个后缀的 lcp</p><p>走不动之后我们需要向下转，设我们走到了 $(x,y^\prime)$，你们在其斜线靠左的部分是否可达都不重要，因为不会对答案造成贡献，那么我们需要知道的就是所有 $(x_1,y_1)$，满足 $x_1&gt;x,x_1+y_1=x+y^\prime$ 是否可达，那么走到这里之后，我们最靠上能访问的行至少向下移动了 $1$，也就是这样的情况只会发生 $O(n)$ 次</p><p>那么我们现在需要解决的是，对于一个串 $(x,y)-(x,y^\prime)$，给定 $(x,y)$ 斜线上的可达状态，求 $(x,y^\prime)$ 斜线上的可达状态</p><p>这个可以用二进制压位，然后在猫树上维护信息，在猫树上维护中点斜线上每个格子向左向右，能走到斜线上的哪些格子，复杂度 $O(n^2m\log m+qn^2)$</p><p>如果使用 SA 求 lcp，总复杂度为 $O(L\log L+n^2m\log m+qn^2)$，但是 SA 是一场宏大的骗局，所以应该使用二分 hash 判断 lcp，复杂度 $O(L+n^2m\log m+qn(n+\log m))$</p>
              </div>
            </details>
<hr>
<h3 id="29-UNR8-难度查找-K-⭐"><a href="#29-UNR8-难度查找-K-⭐" class="headerlink" title="29.  UNR8 - 难度查找 [K] ⭐"></a>29.  UNR8 - 难度查找 [K] ⭐</h3><h4 id="题面-28"><a href="#题面-28" class="headerlink" title="题面"></a>题面</h4><p>交互题。</p>
<p>有一个 $n\times n$ 的正整数矩阵 $a$，满足每行递增且每列递增，你每次可以询问一个位置的值，求第 $k$ 小</p>
<p>$1\le n\le2\times10^5,1\le k\le n^2,0\le a_i\le10^{18}$，最多询问 $10^6$ 次</p>
<h4 id="题解-28"><a href="#题解-28" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>啊啊啊。</p><p>直接做不好做，考虑提取偶数列，我们在偶数列中求第 $\lfloor(k-n)/2\rfloor$ 大，那么答案一定包含这些值，现在我们有 $\lfloor(k-n)/2\rfloor\times2$ 个数了，需要再添加 $O(n)$ 个，使用 <code>priority_queue</code>，不断添加每一行最右边的数，实现这个事情</p><p>偶数行列交替取，目前我们的询问次数是 $T(n,m)=T(m,n/2)+2n$，即 $6n$</p><p>加记忆化以及一个剪枝：如果 $(x-1,y)$ 或 $(x,y-1)$ 不在前 $k$ 小里，就不将 $(x,y)$ 加入 <code>priority_queue</code></p><p>可以说明，这样剪完之后询问次数最多为 $5n$</p><p>具体地，考虑 $T(n,n)$ 变为 $T(n/2,n/2)$ 的过程，我们说明最多会使用 $2.5n$ 次询问</p><p>注意到如果我们每次添加都是行的最后一个元素，那么设在处理完 $T(n/2,n)$ 后，设第 $i$ 行取了 $a_i$ 个，处理完 $T(n,n)$ 后，第 $i$ 行取了 $b_i$ 个，那么在处理 $T(n/2,n)$ 时我们会问 $n/2+|\{a_i\}|$ 次，在处理 $T(n,n)$ 时我们会问 $n+|\{b_i\}|$ 次</p><p>不妨先假设操作次数是 $3n/2+n+|\{a_i\}|$，考虑过程中哪些地方会省操作</p><p>注意到对于一个 $a_i\neq a_{i-1}$，$(i,a_i+2)$ 一定在 $T(n/2,n)$ 的时候被问过了，此时如果 $a_i\neq b_i$，那么 $(i,a_i+2)$ 不需要被重新问一次，询问次数可以 $-1$，如果 $a_i=b_i$，那么 $b$ 一定不能包含 $a_i+1$，$|\{b_i\}|$ 可以 $-1$</p><p>因此最后一定减了 $|\{a_i\}|$，也就是总这部分询问次数最多为 $2.5n$</p><p>那么总共询问次数最多为 $5n$</p>
              </div>
            </details>
<hr>
<h3 id="30-UNR8-大海的深度-K-✔️"><a href="#30-UNR8-大海的深度-K-✔️" class="headerlink" title="30.  UNR8 - 大海的深度 [K] ✔️"></a>30.  UNR8 - 大海的深度 [K] ✔️</h3><h4 id="题面-29"><a href="#题面-29" class="headerlink" title="题面"></a>题面</h4><p>给定 $a_1,a_2,\cdots,a_n$，$q$ 次单点修改，每次修改后输出 $\sum_{1\le i\le j\le n}\min(a[i:j])$</p>
<p>$1\le n,m\le2\times10^5,1\le a_i\le10^6$</p>
<h4 id="题解-29"><a href="#题解-29" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>asdkchksafdlkajfklasdfljghkjadfdf</p><p>考虑单次答案怎么求：有两种方式，分治或者笛卡尔树，而动态维护笛卡尔树是一个很困难的事情，因此我们考虑分治</p><p>那么分治用一个 $\log$ 的代价将问题转化为统计跨过中点的所有区间</p><p>考虑计算 $\ge j$ 的区间数量，那么最后的答案就是 $\sum_j p_jq_j$，其中 $p_j$ 表示 $[L,M]$ 内最后一个 $\le j$ 的数到 $M$ 的距离，$q_j$ 表示 $[M+1,R]$ 内第一个 $\le j$ 的数到 $M+1$ 的距离</p><p>直接做的话，这是一个单点修改，全局求 $\sum\min(p^\prime[1:j])\min(q^\prime[1:j])$，用单侧递归线段树可以做到 $\log^3$</p><p>单侧递归无用论.jpg</p><p>考虑换一换维度：按照 $j$ 为时间轴，询问为下标，注意到此时每个存在过的数，对 $p$ 和 $q$ 是区间取 $\min$，最后查询的是每个位置 $pq$ 的历史和</p><p>这个使用 segbeats 维护，加上外面的 $\log$，复杂度 $O(n\log^2n)$</p><p>实现较为复杂。</p>
              </div>
            </details>
<hr>
<h3 id="31-UR25-见贤思齐-E"><a href="#31-UR25-见贤思齐-E" class="headerlink" title="31.  UR25 - 见贤思齐 [E]"></a>31.  UR25 - 见贤思齐 [E]</h3><h4 id="题面-30"><a href="#题面-30" class="headerlink" title="题面"></a>题面</h4><p>有 $n$ 个变量 $x_1,x_2,\cdots,x_n$，给定它们的初值，额外给定数组 $p_1,p_2,\cdots,p_n$，每一时刻，下面的事情会同时发生：</p>
<ul>
<li>对于所有 $i$，如果 $x_{p_i}\ge x_i$，那么 $x_i\leftarrow x_i+1$</li>
</ul>
<p>$q$ 次询问，每次询问给定 $g,d$，求 $x_g$ 在 $d$ 时刻的值</p>
<p>$1\le n,q\le2\times10^5,1\le a_i\le10^9,1\le d\le2\times10^5$</p>
<h4 id="题解-30"><a href="#题解-30" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>手模。</p><p>首先一个环，可以发现最小值一定在不断 $+1$，这个也容易归纳证明</p><p>那么我们就可以把环断开，转化成树上的问题</p><p>接着手模，我们可以发现当 $x_i$ 和 $x_{p_i}$ 第一次相等之后，$x_i$ 在 $d$ 时刻的值等于 $x_{p_i}$ 在 $d-1$ 时刻的值 $+1$</p><p>相当于我们对每个节点求 $tim_i$ 表示 $x_i$ 第一次和 $x_{p_i}$ 相等，那么求答案就是链上查询最后一个 $\ge x$ 的值，这个可以树上倍增，求 $tim$ 的话套一个二分即可</p><p>复杂度 $O(n\log^2n)$</p>
              </div>
            </details>
<hr>
<h3 id="32-UR25-装配序列-K-✨"><a href="#32-UR25-装配序列-K-✨" class="headerlink" title="32.  UR25 - 装配序列 [K] ✨"></a>32.  UR25 - 装配序列 [K] ✨</h3><h4 id="题面-31"><a href="#题面-31" class="headerlink" title="题面"></a>题面</h4><p>给定 $1\sim n$ 的排列 $p$，定义 $P$ 为 $p$ 重复无穷多次得到的结果，$m$ 次询问，每次给定一个 $x$，求 $P[1:x]$ 的最长严格递增子序列</p>
<p>$1\le n\le2\times10^5,1\le m\le10^6,1\le x\le10^{18}$</p>
<h4 id="题解-31"><a href="#题解-31" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>太抽象了。</p><p>考虑贪心求 LIS，但直接做显然没前途，考虑顺着值扫，维护下标序列，即 $f_{i,j}$ 表示考虑完值 $=i$，长度为 $j$ 的子序列最早出现位置，那么每次加值就是二分位置然后覆盖进去，最后的答案就是最后一个 $\le x$ 的数的位置</p><p>出于某种原因，每种数保留的位置在任何时候都是一个前缀，不妨假设 $pos=i$ 的数保留了 $c_i$ 个，分析一下加入 $pos=x$ 的数 $i$ 时会产生什么影响</p><p>依次考虑它顶掉的下一个数，那么就是顺次执行如下过程：</p><ul><li>$c_x\leftarrow 0$</li><li>对于每个 $[x+1,n]$，如果 $c_x&lt;c_i$，那么交换 $c_x,c_i$</li><li>对于每个 $[1,x-1]$，如果 $c_x&lt;c_i-1$，那么交换 $c_x,c_i$，然后 $c_x\leftarrow c_x-1,c_i\leftarrow c_i+1$</li><li>最后 $c_x\leftarrow c_x+1$</li></ul><p>直接做是 $O(n^2+m\log n)$ 的</p><p>注意到 $\sum c_i=O(n)$，因此我们可以考虑根号分治维护，具体地，对于 $\le B$ 的 $c_i$，我们发现只用考虑它们第一次出现位置（从 $x$ 出发），因为在过程中 $c_x$ 一定单调增，对于 $&gt;B$ 的 $c_i$ 我们直接找到所有位置</p><p>这样我们可以在 $O(B\log n+\frac nB)$ 的时间复杂度内找到 $O(B+\frac nB)$ 个可能有用的位置，直接暴力判一下即可</p><p>大于 $B$ 的部分需要精细实现才能做到不带 log</p>
              </div>
            </details>
<hr>
<h3 id="33-QOJ8938-Crawling-on-a-Tree-K-⭐"><a href="#33-QOJ8938-Crawling-on-a-Tree-K-⭐" class="headerlink" title="33.  QOJ8938 - Crawling on a Tree [K] ⭐"></a>33.  QOJ8938 - Crawling on a Tree [K] ⭐</h3><h4 id="题面-32"><a href="#题面-32" class="headerlink" title="题面"></a>题面</h4><p>给定一棵 $n$ 个点的树，初始 $1$ 号点上有 $m$ 只龟，每条边有两个属性 $l,k$，$l$ 表示这条边的长度，$k$ 表示这条边最多经过的龟数（经过 $k$ 次后不能再经过）</p>
<p>第 $i$ 个点有一个要求 $c_i$，表示必须有 $c_i$ 只不同的龟经过这个点，求这 $m$ 只龟的经过的距离 $\sum l$ 总和的最小值，或判断无解</p>
<p>给定 $M$，请输出 $m=1,2,\cdots,M$ 的所有答案</p>
<p>$2\le n\le10^4,1\le M\le10^4$</p>
<h4 id="题解-32"><a href="#题解-32" class="headerlink" title="题解"></a>题解</h4><details class="black" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>Sol </summary>
              <div class='content'>
              <p>考虑树形 dp，令 $dp_{i,x,y}$ 表示 $i$ 的子树，一共进入了 $x$ 只龟，有 $y$ 只龟不回来了</p><p>那么注意到 $x_u,y_u$ 需要满足的若干限制：</p><ul><li>$x_u\ge y_u$</li><li>$2x_u-y_u\le k_u$，其中 $k_u$ 为 $u$ 父亲边的 $k$ 值</li><li>$x_u\ge\max x_v$</li><li>$y_u=\sum y_v$</li></ul><p>那么可以写出一个 $O(nm^4)$ 的转移，这个十分愚蠢，考虑优化</p><p>注意到对于同一个 $y$，一定 $x=\max(y,\max c)$ 的时候取到最小值，其中 $\max c$ 为子树 $c$ 最大值，那么可以简化状态为 $dp_{i,y}$，转移 $O(nm^2)$</p><p>进一步可以归纳证明 $dp_i$ 关于 $y$ 是凸的，转移闵和即可，复杂度 $O(nm)$</p>
              </div>
            </details>
<hr>
<h3 id="34-QOJ5095-九王唱-E-⭐"><a href="#34-QOJ5095-九王唱-E-⭐" class="headerlink" title="34.  QOJ5095 - 九王唱 [E] ⭐"></a>34.  QOJ5095 - 九王唱 [E] ⭐</h3><h4 id="题面-33"><a href="#题面-33" class="headerlink" title="题面"></a>题面</h4><p>有 $n$ 个人，$n+1$ 首歌，第 $i$ 个人有一个 $1\sim n+1$ 的排列 $a_i$，表示第 $i$ 个人对第 $j$ 首歌的喜爱程度</p>
<p>有一个整数 $p$，你需要按 $p,p+1,\cdots,n,1,2,\cdots,p-1$ 的顺序考虑所有人，每个人可以删掉任意一首还没有被删除的歌，每个人都希望</p>
<h4 id="题解-33"><a href="#题解-33" class="headerlink" title="题解"></a>题解</h4>
		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> task11</li>
        <li><strong>Author:</strong> Flamire</li>
        <li><strong>Created at
                :</strong> 2024-04-29 00:00:00</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-03-05 18:05:07
            </li>
        
        <li>
            <strong>Link:</strong> https://flamire.github.io/2024/04/29/task11/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2024/09/10/task12/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">task12</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2024/03/08/task10/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">task10</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://example.example.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          reaction: false,
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">task11</div>
		<ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-CF1329E-Dreamoon-Loves-AA-E"><span class="nav-text">1.  CF1329E - Dreamoon Loves AA [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-ARC159E-Difference-Sum-Query-K"><span class="nav-text">2.  ARC159E - Difference Sum Query [K]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-CF1924E-Paper-Cutting-Again-E"><span class="nav-text">3.  CF1924E - Paper Cutting Again [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-CF1975G-Zimpha-Fan-Club-E-%E2%AD%90"><span class="nav-text">4.  CF1975G - Zimpha Fan Club [E] ⭐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-CF1975H-378QAQ-and-Core-E"><span class="nav-text">5.  CF1975H - 378QAQ and Core [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-THUPC2024-Final-A-%E5%8F%A4%E6%98%8E%E5%9C%B0%E6%9E%A3%E7%9A%84%E8%A2%9C%E5%AD%90-K-%E2%9C%94%EF%B8%8F"><span class="nav-text">6.  THUPC2024 Final A - 古明地枣的袜子 [K] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-CF1119H-Triple-E"><span class="nav-text">7.  CF1119H - Triple [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-CF1750G-Doping-E"><span class="nav-text">8.  CF1750G - Doping [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-CF1129E-Legendary-Tree-E"><span class="nav-text">9.  CF1129E - Legendary Tree [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-JOISC2017-%E5%BC%80%E8%8D%92%E8%80%85-K-%E2%9C%94%EF%B8%8F"><span class="nav-text">10.  JOISC2017 - 开荒者 [K] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-JOISC2017-%E6%B8%AF%E5%8F%A3%E8%AE%BE%E6%96%BD-S"><span class="nav-text">11.  JOISC2017 - 港口设施 [S]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-JOISC2017-%E7%83%9F%E8%8A%B1%E6%A3%92-E"><span class="nav-text">12.  JOISC2017 - 烟花棒 [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-JOISC2017-%E9%97%A8%E7%A5%A8%E5%AE%89%E6%8E%92-E-%E2%AD%90"><span class="nav-text">13.  JOISC2017 - 门票安排 [E] ⭐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-JOISC2017-%E7%81%AB%E8%BD%A6%E6%97%85%E8%A1%8C-S"><span class="nav-text">14.  JOISC2017 - 火车旅行 [S]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-CF1909I-Short-Permutation-Problem-K"><span class="nav-text">15.  CF1909I - Short Permutation Problem [K]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-CF1909H-Parallel-Swaps-Sort-E"><span class="nav-text">16.  CF1909H - Parallel Swaps Sort [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-CF1965F-Conference-K-%E2%AD%90"><span class="nav-text">17.  CF1965F - Conference [K] ⭐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-CF1930G-Prefix-Max-Set-Counting-E-%E2%AD%90"><span class="nav-text">18.  CF1930G - Prefix Max Set Counting [E] ⭐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#19-CF1817F-Entangled-Substrings-E"><span class="nav-text">19.  CF1817F - Entangled Substrings [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20-CF1738H-Palindrome-Addict-E"><span class="nav-text">20.  CF1738H - Palindrome Addict [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-AT-dwacon5th-prelims-e-Cyclic-GCDs-E"><span class="nav-text">21.  AT_dwacon5th_prelims_e Cyclic GCDs [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22-CF1394E-Boboniu-and-Banknote-Collection-E-%E2%9C%94%EF%B8%8F"><span class="nav-text">22.  CF1394E - Boboniu and Banknote Collection [E] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23-CF1098F-%D0%96-function-K"><span class="nav-text">23.  CF1098F - Ж-function [K]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#24-AGC067B-Modifications-K-%E2%9C%94%EF%B8%8F"><span class="nav-text">24.  AGC067B - Modifications [K] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#25-AGC067D-Unique-Matching-E-%E2%9C%94%EF%B8%8F"><span class="nav-text">25.  AGC067D - Unique Matching [E] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#26-NOI2023-%E5%90%88%E5%B9%B6%E4%B9%A6%E6%9C%AC-K-%E2%9C%94%EF%B8%8F"><span class="nav-text">26.  NOI2023 - 合并书本 [K] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#27-UNR8-%E9%87%8C%E5%A4%96%E4%B8%80%E8%87%B4-K-%E2%AD%90"><span class="nav-text">27.  UNR8 - 里外一致 [K] ⭐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#28-UNR8-%E4%BA%8C%E7%BB%B4%E6%8A%84%E8%A2%AD%E6%A3%80%E6%B5%8B-E-%E2%9C%94%EF%B8%8F"><span class="nav-text">28.  UNR8 - 二维抄袭检测 [E] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#29-UNR8-%E9%9A%BE%E5%BA%A6%E6%9F%A5%E6%89%BE-K-%E2%AD%90"><span class="nav-text">29.  UNR8 - 难度查找 [K] ⭐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-UNR8-%E5%A4%A7%E6%B5%B7%E7%9A%84%E6%B7%B1%E5%BA%A6-K-%E2%9C%94%EF%B8%8F"><span class="nav-text">30.  UNR8 - 大海的深度 [K] ✔️</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#31-UR25-%E8%A7%81%E8%B4%A4%E6%80%9D%E9%BD%90-E"><span class="nav-text">31.  UR25 - 见贤思齐 [E]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#32-UR25-%E8%A3%85%E9%85%8D%E5%BA%8F%E5%88%97-K-%E2%9C%A8"><span class="nav-text">32.  UR25 - 装配序列 [K] ✨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#33-QOJ8938-Crawling-on-a-Tree-K-%E2%AD%90"><span class="nav-text">33.  QOJ8938 - Crawling on a Tree [K] ⭐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#34-QOJ5095-%E4%B9%9D%E7%8E%8B%E5%94%B1-E-%E2%AD%90"><span class="nav-text">34.  QOJ5095 - 九王唱 [E] ⭐</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Flamire</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        47 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>





    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>

</html>